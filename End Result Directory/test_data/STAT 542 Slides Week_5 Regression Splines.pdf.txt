regression splines basis expansion approach php err where pm for regression with cubic splines and pm for nc represent the model on the observed data points using matrix notation arg inky fk 215 where bbbb bbb by yn cccccc can 10 bbbb bbbb px px nh nh px cccccc can bbbb ccc cap err we can obtain the design matrix by command sbs or ns in rand then call the regression function lm 16 understand how counts the degree of feed om to generate cubic spline basis for given set of is you can use the command bs you can tell the location of knots or you can tell the df recall that cubic spline with knots has df so we need df knots by default puts knots at the mm quan tiles of 17 how counts the df is little confusing the df in command bs actually means the number of columns of the design matrix returned by bs so if the intercept is not included in the design matrix which is the default then the df in command bs is equal to the real df minus so the following three design matrices the two are of and the last one is of correspond to the same regression model with cubic splines of df bs knots quant ilex 1323 bs df bs df intercept true 18 to generate anc basis for given set of is use the command ns recall that the linear functions in the two extreme intervals are totally determined by the other cubic splines even if no data points are in the two extreme intervals ie data points are inside the two boundary knots by default puts the two boundary knots as them in and max of is you can tell the location of knots which are the interior knots recall that anc with knots has df so the df is equal to the number of interior knots plus where means the two boundary knots 19 or you can tell the df if intercept true then we need df knots otherwise we need df knots again by default puts knots at the mm quan tiles of the following three design matrices the rst two are of and the last one is of correspond to the same regression model with nc so fdf nsx knots quant ilex 1323 nsx df nsx df intercept true 20
